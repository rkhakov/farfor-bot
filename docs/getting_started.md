# Начало работы


## Предварительные требования
* [Poetry](https://github.com/python-poetry/poetry) - Используется для управления зависимостями
* `docker-compose` - Для запуска базы на дев окружении


## Клонируем репозиторий
```shell
> git clone git@github.com:rkhakov/farfor-bot.git
> cd farfor-bot
```


## Установка зависимостей
```shell
 poetry install
```
В корне проекта находится файл `poetry.toml` в котором указано создавать виртуальное окружение в проекте.
После установки зависимостей, должна появиться директория c виртуальным окружением `.venv`


## Конфигурация
Копируем пример конфига в файл `.env`
```shell
> cp .env.example .env
```

Для работы с телеграм ботом, нужно указать его токен в поле `TELEGRAM_TOKEN`

Конфигурация поддерживает получение данных из переменных окружения.

> Переменные окружения приоритетнее над файлом `.env`

```shell
export TELEGRAM_TOKEN=SECRET_TOKEN
```


## Запускаем базу
```shell
> docker-compose up -d
```


## Инициализация базы
Команда создает базу, если не создана и накатывает миграции

```shell
> poetry run farfor_bot database init
```


## Запуск develop окружения
После установки зависимостей можно запустить дев сервер используя cli.
```shell
> poetry run farfor_bot server develop
```

Посмотреть все доступные команды
```shell
> poetry run farfor_bot --help
```


## Активация виртуального окружения
Если удобней работать через виртульное окружение, не используя `poetry run`, то активируем его командой
```shell
> source .venv/bin/activate
```

После активации команды cli нужно запускать следующим образом
```shell
> python -m farfor_bot --help
```


## OpenAPI Doc
По умолчанию проект стартут на 8900 порту

* [Документация API](http://127.0.0.1:8900/docs)
